!function(z){z.cookieBar=function(t,e){if("cookies"==t)var i="cookies";else if("set"==t)i="set";else i=!1;var n={message:"We use cookies to track usage and preferences.",acceptButton:!0,acceptText:"I Understand",acceptFunction:function(e){"enabled"!=e&&"accepted"!=e&&(window.location=window.location.href)},declineButton:!1,declineText:"Disable Cookies",declineFunction:function(e){"enabled"!=e&&"accepted"!=e||(window.location=window.location.href)},policyButton:!1,policyText:"Privacy Policy",policyURL:"/privacy-policy/",autoEnable:!0,acceptOnContinue:!1,acceptOnScroll:!1,acceptAnyClick:!1,expireDays:365,renewOnVisit:!1,forceShow:!1,effect:"slide",element:"body",append:!1,fixed:!1,bottom:!1,zindex:"",domain:String(window.location.hostname),referrer:String(document.referrer)},o=(t=z.extend(n,t),new Date);o.setTime(o.getTime()+864e5*t.expireDays);var r,s,a="cb-enabled={value}; expires="+(o=o.toGMTString())+"; path=/",l="",d=document.cookie.split("; ");for(r=0;r<d.length;r++)"cb-enabled"==(s=d[r].split("="))[0]&&(l=s[1]);if(""==l&&"cookies"!=i&&t.autoEnable?(l="enabled",document.cookie=a.replace("{value}","enabled")):"accepted"!=l&&"declined"!=l||"cookies"==i||!t.renewOnVisit||(document.cookie=a.replace("{value}",l)),t.acceptOnContinue&&0<=t.referrer.indexOf(t.domain)&&-1==String(window.location.href).indexOf(t.policyURL)&&"cookies"!=i&&"set"!=i&&"accepted"!=l&&"declined"!=l&&(i="set",e="accepted"),"cookies"==i)return"enabled"==l||"accepted"==l;if("set"==i&&("accepted"==e||"declined"==e))return document.cookie=a.replace("{value}",e),"accepted"==e;var u=t.message.replace("{policy_url}",t.policyURL);if(t.acceptButton)var c='<a href="" class="cb-enable">'+t.acceptText+"</a>";else c="";if(t.declineButton)var p='<a href="" class="cb-disable">'+t.declineText+"</a>";else p="";if(t.policyButton)var h='<a href="'+t.policyURL+'" class="cb-policy">'+t.policyText+"</a>";else h="";if(t.fixed)if(t.bottom)var f=' class="fixed bottom"';else f=' class="fixed"';else f="";if(""!=t.zindex)var v=' style="z-index:'+t.zindex+';"';else v="";!t.forceShow&&"enabled"!=l&&""!=l||(t.append?z(t.element).append('<div id="cookie-bar"'+f+v+"><p>"+u+c+p+h+"</p></div>"):z(t.element).prepend('<div id="cookie-bar"'+f+v+"><p>"+u+c+p+h+"</p></div>"));function m(e){t.acceptOnScroll&&z(document).off("scroll"),"function"==typeof e&&e(l),"slide"==t.effect?z("#cookie-bar").slideUp(300,function(){z("#cookie-bar").remove()}):"fade"==t.effect?z("#cookie-bar").fadeOut(300,function(){z("#cookie-bar").remove()}):z("#cookie-bar").hide(0,function(){z("#cookie-bar").remove()}),z(document).unbind("click",g)}function b(){document.cookie=a.replace("{value}","accepted"),m(t.acceptFunction)}var g=function(e){z(e.target).hasClass("cb-policy")||b()};if(z("#cookie-bar .cb-enable").click(function(){return b(),!1}),z("#cookie-bar .cb-disable").click(function(){return function(){var e=new Date;for(e.setTime(e.getTime()-864e6),e=e.toGMTString(),d=document.cookie.split("; "),r=0;r<d.length;r++)0<=(s=d[r].split("="))[0].indexOf("_")?document.cookie=s[0]+"=0; expires="+e+"; domain="+t.domain.replace("www","")+"; path=/":document.cookie=s[0]+"=0; expires="+e+"; path=/";document.cookie=a.replace("{value}","declined"),m(t.declineFunction)}(),!1}),t.acceptOnScroll){var $,y=z(document).scrollTop();z(document).on("scroll",function(){$=z(document).scrollTop(),(y<$?$-y:y-$)>=Math.round(t.acceptOnScroll)&&b()})}t.acceptAnyClick&&z(document).bind("click",g)}}(jQuery);var url=Routing.generate("qm_tuttovisure_privacy");$(document).ready(function(){$.cookieBar({message:"Il nostro sito web utilizza cookies di terzi parti. Continuando la navigazione, si accetta l'uso dei cookies che ci consente di fornire un servizio ottimale e contenuti personalizzati.",acceptButton:!0,acceptText:"CHIUDI",policyButton:!0,policyText:"Informativa",policyURL:url,fixed:!0,bottom:!0,append:!0,acceptOnContinue:!0,acceptAnyClick:!0})}),"undefined"==typeof Tuttovisure&&(Tuttovisure={}),Tuttovisure.ua=detect.parse(navigator.userAgent),Tuttovisure.parziali={totale:"0,00",imponibile:"0,00",anticipazioni:"0,00",iva:"0,00",importoScontoDaCodice:"0,00",codiceScontoAdvisor:!1},Tuttovisure.currentXhr=null,Tuttovisure.provinciaComune=function(t,i,n){$(i).prop("disabled",!0),$.ajax({url:Routing.generate("qm_tuttovisure_comuni_options",{provincia:$(t).val()}),dataType:"json",success:function(e){$(t).is("input:radio")&&($(this).find(":checked")?($(i).prop("disabled",!1),$(i).prop("required",!0),$(i).empty(),$(n).html(""),$(i).append($("<option>").text("Seleziona il comune").prop("value","")),$.each(e,function(e,t){$(i).append($("<option>").text(t.nome).prop("value",t.id))})):($(i).empty(),$(i).trigger("change"),$(i).prop("disabled",!0),$(i).prop("required",!1),$(n).html(""))),$(t).is("select")&&(""===$(t).val()?($(i).empty(),$(i).trigger("change"),$(i).prop("disabled",!0),$(i).prop("required",!1),$(n).html("")):($(i).prop("disabled",!1),$(i).prop("required",!0),$(i).empty(),$(n).html(""),$(i).append($("<option>").text("Seleziona il comune").prop("value","")),$.each(e,function(e,t){$(i).append($("<option>").text(t.nome).prop("value",t.id))})))},error:function(e){}})},Tuttovisure.Cliente={validaForm:function(t,i){void 0===i&&(i=!1),$("#"+t+"cliente_tipoCliente_0").prop("checked")&&Tuttovisure.Cliente.personaFisica(t,i),$("#"+t+"cliente_tipoCliente_1").prop("checked")&&Tuttovisure.Cliente.azienda(t,i),$("#"+t+"cliente_tipoCliente_2").prop("checked")&&Tuttovisure.Cliente.professionista(t,i),$("#"+t+"cliente_tipoCliente input").click(function(){$("#partitaIva").find("div[class*='col-md-7']").addClass("req"),$("#codiceFiscaleCliente").find("div[class*='col-md-7']").addClass("req");var e=$(this).val();"persona_fisica"==e&&Tuttovisure.Cliente.personaFisica(t,i),"azienda"==e&&Tuttovisure.Cliente.azienda(t,i),"professionista"==e&&Tuttovisure.Cliente.professionista(t,i)})},personaFisica:function(e,t){$("#nome").removeClass("alert-form alert-danger-form"),$("#nome").find("span[class*='alert-message']").remove(),$("#cognome").removeClass("alert-form alert-danger-form"),$("#cognome").find("span[class*='alert-message']").remove(),$("#nome").find("input:text").prop("required",!0),$("#comune").removeClass("alert-form alert-danger-form"),$("#comune").find("span[class*='alert-message']").remove(),$("#datiCliente").removeClass("hidden"),$("#datiPersona").removeClass("hidden"),$("#codiceFiscaleCliente").find("input:text").prop("required",!0),$("#codiceFiscaleCliente").find("input:text").keydown(function(e){16<=$(this).val().length&&$(this).val($(this).val().substr(0,16))}),$("#codiceFiscaleCliente").find("input:text").keyup(function(e){16<=$(this).val().length&&$(this).val($(this).val().substr(0,16))}),$("#datiAzienda").addClass("hidden"),$("#datiAzienda").find("input:text, select").prop("required",!1),$("#datiAzienda").find("input:text").val(""),$("#pIvaSettore").addClass("hidden"),$("#pIvaSettore").find("input:text, select").prop("required",!1),$("#pIvaSettore").find("input:text").val(""),$("#pIvaSettore").find("select").val(0),$("#email").find("input:text").prop("required",!0),$("#nome").closest("div").find("label").html("Nome:"),$("#nome").find("input:text").prop("required",!0),$("#cognome").closest("div").find("label").html("Cognome:"),$("#cognome").find("input:text").prop("required",!0),$("#provincia").closest("div").find("label").html("Provincia:"),$("#provincia").find("input:text, select").prop("required",!0),$("#comune").closest("div").find("label").html("Comune:"),$("#indirizzo").closest("div").find("label").html("Indirizzo:"),$("#indirizzo").find("input:text").prop("required",!0),$("#cap").closest("div").find("label").html("Cap:"),$("#cap").find("input:text").prop("required",!0),t&&($("#datiPersona").find("input:text, select").prop("required",!0),$("#recapiti").find("input:text, select").prop("required",!0)),$("#"+e+"cliente_nazione").length&&$("#"+e+"cliente_nazione").val(Tuttovisure.parziali.nomeSpedizione)},azienda:function(e,t){$("#datiCliente").removeClass("hidden"),$("#datiAzienda").removeClass("hidden"),$("#partitaIva").find("input:text").prop("required",!0),$("#datiPersona").addClass("hidden"),$("#datiPersona").find("input:text, select").prop("required",!1),$("#datiPersona").find("input:text").val(""),$("#pIvaSettore").removeClass("hidden"),$("#email").find("input:text").prop("required",!0),$("#provincia").find("div[class*='col-md-7']").addClass("req"),$("#provincia").closest("div").find("label").html("Provincia:"),$("#comune").closest("div").find("label").html("Comune:"),$("#indirizzo").find("div[class*='col-md-7']").addClass("req"),$("#indirizzo").closest("div").find("label").html("Indirizzo:"),$("#cap").find("div[class*='col-md-7']").addClass("req"),$("#cap").closest("div").find("label").html("Cap:"),t&&($("#datiAzienda").find("input:text, select").prop("required",!0),$("#recapiti").find("input:text, select").prop("required",!0)),$("#"+e+"cliente_nazione").length&&$("#"+e+"cliente_nazione").val(Tuttovisure.parziali.nomeSpedizione)},professionista:function(e,t){$("#datiCliente").removeClass("hidden"),$("#datiPersona").removeClass("hidden"),$("#codiceFiscaleCliente").removeClass("hidden"),$("#codiceFiscaleCliente").find("input:text").prop("required",!0),$("#codiceFiscaleCliente").find("input:text").keydown(function(e){16<=$(this).val().length&&$(this).val($(this).val().substr(0,16))}),$("#codiceFiscaleCliente").find("input:text").keyup(function(e){16<=$(this).val().length&&$(this).val($(this).val().substr(0,16))}),$("#datiAzienda").addClass("hidden"),$("#datiAzienda").find("input:text, select").prop("required",!1),$("#datiAzienda").find("input:text").val(""),$("#pIvaSettore").removeClass("hidden"),$("#partitaIva").find("input:text").prop("required",!0),$("#email").find("input:text").prop("required",!0),$("#nome").find("div[class*='col-md-7']").addClass("req"),$("#nome").closest("div").find("label").html("Nome:"),$("#cognome").find("div[class*='col-md-7']").addClass("req"),$("#cognome").closest("div").find("label").html("Cognome:"),$("#provincia").find("div[class*='col-md-7']").addClass("req"),$("#provincia").closest("div").find("label").html("Provincia:"),$("#comune").closest("div").find("label").html("Comune:"),$("#indirizzo").find("div[class*='col-md-7']").addClass("req"),$("#indirizzo").closest("div").find("label").html("Indirizzo:"),$("#cap").find("div[class*='col-md-7']").addClass("req"),$("#cap").closest("div").find("label").html("Cap:"),t&&($("#datiPersona").find("input:text, select").prop("required",!0),$("#pIvaSettore").find("input:text, select").prop("required",!0),$("#recapiti").find("input:text, select").prop("required",!0)),$("#"+e+"cliente_nazione").length&&$("#"+e+"cliente_nazione").val(Tuttovisure.parziali.nomeSpedizione)}},Tuttovisure.Ordine={aggiornaParziali:function(){var i=$("#prodotto-form").serialize();$.each($("#prodotto-form input[type=checkbox]").filter(function(e){return!1===$(this).prop("checked")}),function(e,t){i+="&"+$(t).attr("name")+"="}),i=i+"&prodotto="+$("#prodotto-form").data("prodotto"),Tuttovisure.currentXhr&&Tuttovisure.currentXhr.abort();var e=Routing.generate("qm_tuttovisure_prodotto_parziali_ordine");if($("#page").attr("frontendflag")){var t=JSON.parse($("#page").attr("frontendflag"));e=Routing.generate("qm_tuttovisure_prodotto_parziali_ordine_no_session",{id:t.pagamentoTardivoFlag})}Tuttovisure.currentXhr=$.ajax({type:"GET",url:e,data:i,dataType:"json",success:function(e){"function"==typeof filtraDatiParziali&&(e=filtraDatiParziali(e)),"function"==typeof filtraMessaggiUrgenza&&(e=filtraMessaggiUrgenza(e),$("#bloccoOrdineUrgenza").find("input:checkbox").prop("checked",!1)),"function"==typeof filtraSpedizioni&&(e=filtraSpedizioni(e));var i=[];$.each(e.opzioni,function(e,t){"0,00"!=t.imponibile&&i.push(t)}),parziali=Tuttovisure.parziali,parziali.totale=e.totale,parziali.imponibile=e.imponibile,parziali.imponibileUrgenza=e.imponibileUrgenza,parziali.anticipazioni=e.anticipazioni,parziali.vociAnticipazioni=e.vociAnticipazioni,parziali.iva=e.iva,parziali.opzioni=i,parziali.dati=e.datiProdotto,parziali.urgenza=e.urgenza,parziali.tempiUrgenza=e.tempiUrgenza,parziali.tempiLavorazione=e.tempiLavorazione,parziali.upselling=e.upselling,parziali.imponibileTutte=e.imponibileTutte,parziali.imponibileTutteAnticipazioni=e.imponibileTutteAnticipazioni,parziali.spedizione=e.spedizione,parziali.imponibileSpedizione=e.imponibileSpedizione,parziali.nomeSpedizione=e.nomeSpedizione,parziali.prezzoBase=e.prezzoBase,parziali.scontoTotale=e.scontoTotale,parziali.scontoPercentuale=e.scontoPercentuale,parziali.importoScontoDaCodice=e.importoScontoDaCodice,parziali.codiceScontoAdvisor=e.codiceScontoAdvisor;var t,n=$("#codiceScontoEccessoAdvisor");n.length&&parziali.codiceScontoAdvisor&&n.removeClass("hidden"),0<=navigator.userAgent.toLowerCase().indexOf("msie 8")&&(t=e,$("#riepilogo table tbody").html(""),$.each(t.opzioni,function(e,t){"sms"!=t.testo&&$("#riepilogo table tbody").append("<tr><td>"+t.testo+"</td><td>&euro; "+t.imponibile+"</td></tr>")}),t.urgenza&&$("#riepilogo table tbody").append("<tr><td>Consegna Urgente</td><td>&euro; "+t.imponibileUrgenza+"</td></tr>"),t.spedizione&&$("#riepilogo table tbody").append("<tr><td>Spedizione "+t.nomeSpedizione+"</td><td>&euro; "+t.imponibileSpedizione+"</td></tr>"),t.scontoPercentuale&&$("#riepilogo table tbody").append("<tr><td>Sconto "+t.scontoPercentuale+"%</td><td>&euro; "+t.scontoTotale+"</td></tr>"),"Object"==typeof t.opzioni.sms&&$("#riepilogo table tbody").append("<tr><td>"+t.opzioni.sms.testo+"</td><td>&euro; "+t.opzioni.sms.imponibile+"</td></tr>"),$.each(t.vociAnticipazioni,function(e,t){$("#riepilogo table tbody").append('<tr class="active"><td>'+t.testo+"</td><td>&euro; "+t.valore+"</td></tr>")}),$("#riepilogo table tbody").append('<tr class="active"><td>Totale Imponibile</td><td>&euro; '+t.imponibile+"</td></tr>"),$("#riepilogo table tbody").append('<tr class="active"><td>Iva</td><td>&euro; '+t.iva+"</td></tr>"),$("#riepilogo table tbody").append('<tr class="totale"><td>TOTALE</td><td>&euro; '+t.totale+"</td></tr>"),console.log("update")),Tuttovisure.currentXhr=null}})},bindRiepilogo:function(){rivets.formatters.getOption=function(e,i){var n;return e&&$.each(e,function(e,t){t.nome==i&&(n=t.imponibile)}),n},rivets.formatters.getNomeOption=function(e,t){var n;return e&&$.each(e,function(e,i){$.each(t,function(e,t){i.nome==t&&(n=i.nome)})}),n},rivets.formatters.getAnticipazione=function(e,i){var n;return e&&$.each(e,function(e,t){t.nome==i&&(n=t.valore)}),n},rivets.formatters.filterOption=function(e,i){var n=new Array;return e&&$.each(e,function(e,t){t.nome!==i&&n.push(t)}),n},rivets.formatters.getSingleOption=function(e,i){var n;return e&&$.each(e,function(e,t){t.nome==i&&(n=t)}),n?[n]:[]},rivets.formatters.checkDato=function(e,i,n){var o=!1;return e&&$.each(e,function(e,t){t.name==i&&t.val==n&&(o=!0)}),o},rivets.bind($("#sidebar_prodotto"),{parziali:Tuttovisure.parziali}),rivets.bind($("#ordine-urgenza"),{parziali:Tuttovisure.parziali}),rivets.bind($("#urgenzaHeader"),{parziali:Tuttovisure.parziali})},bindChange:function(e){0<$("#prodotto-form").length&&($("#conservatoria_Comune").empty(),$(".come").length||($(".myform").removeClass("hidden"),$("#campi-obbligatori-text").removeClass("hidden")),$("#"+e+"cliente_comune").empty(),$("#"+e+"cliente_provincia").val(""),$("#conservatoria").length||($("#"+e+"datiProdotto_comune").empty(),$("#"+e+"datiProdotto_provincia").val("")),$("#"+e+"datiProdotto_ricercaSu").find("input:radio").prop("checked",!1),1!=$("input[name$='flow_prodotto_step']").val()||$("#prodotto-form").find('input:radio:checked:not([id*="durata"])').length||""!==$("#prodotto-form").data("token")||""!==$("#prodotto-form").find("input:text").val()||$("#prodotto-form").find("input:checkbox:checked").length?($("table[name$='prezzoBase']").addClass("hidden"),$("table[name$='riepilogo']").removeClass("hidden")):($("table[name$='prezzoBase']").removeClass("hidden"),$("#prodotto-form input").one("change keypress",function(e){$("table[name$='riepilogo']").removeClass("hidden"),$("table[name$='prezzoBase']").addClass("hidden"),$("#urg-riepilogo").css("display","block"),$("#scegliUrgenzaStart").css("display","none")}),$("#prodotto-form select").one("change",function(){$("table[name$='riepilogo']").removeClass("hidden"),$("table[name$='prezzoBase']").addClass("hidden"),$("#urg-riepilogo").css("display","block"),$("#scegliUrgenzaStart").css("display","none")})),$("#bonifico").click(function(){$('select[id$="tipoCheckOut"]>option:eq(2)').prop("selected",!0),$("#prodotto-form").submit()}),$("#cartaDiCredito").click(function(){$("select[id$=tipoCheckOut]>option:eq(1)").prop("selected",!0),$("#prodotto-form").submit()}),$("input[id*='urgenza']").on("change",function(){Tuttovisure.Ordine.aggiornaParziali()}),$("select[id*='opzioniProdotto']").on("change",function(e){$(this).logicaOpzioniProdotto().refreshOpzioni(),void 0!==e.originalEvent&&Tuttovisure.Ordine.aggiornaParziali()}),$("input[id*='opzioniProdotto']").on("change",function(e){$(this).logicaOpzioniProdotto().refreshOpzioni(),void 0!==e.originalEvent&&Tuttovisure.Ordine.aggiornaParziali()}),$("select[id*='datiProdotto']").on("change",function(){$(this).logicaOpzioniProdotto().refreshOpzioni()}),$("input[id*='datiProdotto']").on("change",function(){$(this).logicaOpzioniProdotto().refreshOpzioni(),$(this).parents().find("span[id*='riepilogo']")&&Tuttovisure.Ordine.aggiornaParziali()}))},bindFancyBox:function(){$(".fancybox").fancybox({openEffect:"none",closeEffect:"none",autoSize:!1,beforeLoad:function(){this.width=parseInt(this.element.data("fancybox-width")),this.height=parseInt(this.element.data("fancybox-height")),$("#pdf-iframe").attr("src",this.element.data("pdf"))}})},bindConservatoria:function(e){var t=Routing.generate("qm_tuttovisure_prodotto",{slug:"catasto-tavolare",categoriaSlug:"catasto"});$("#conservatoria_Provincia").change(function(){62==$(this).val()||42==$(this).val()||45==$(this).val()?($("#conservatoriaMessage").html('Attenzione! Per la provincia selezionata vige il <a href="'+t+'" target="nuova finestra">Catasto Tavolare</a>.'),conservatoria=0,$("#findConservatoria").addClass("hidden"),$("#conservatoria_Comune").empty(),$("#conservatoria_Comune").prop("disabled",!0)):Tuttovisure.provinciaComune($(this),"#conservatoria_Comune","#conservatoriaMessage")}),$("#conservatoria_Comune").change(function(){var e=$(this).val();$.ajax({url:Routing.generate("qm_tuttovisure_conservatoria_options",{comune:e}),dataType:"json",success:function(e){$.each(e,function(e,t){"id"==e?conservatoria=t:($("#conservatoriaMessage").html('<i class="fas fa-check"></i> La conservatoria di riferimento è: <strong>'+t+"</strong>"),$("#findConservatoria").removeClass("hidden"))})},error:function(){conservatoria=(""!==$("#conservatoria_Provincia").val()?$("#conservatoriaMessage").html('Attenzione! Per il comune selezionato vige il <a href="'+t+'" target="nuova finestra">Catasto Tavolare</a>.'):$("#conservatoriaMessage").html(""),0),$("#findConservatoria").addClass("hidden")}})}),$("#findConservatoria").click(function(){$("#conservatoria_Provincia").val(0),$("#conservatoria_Provincia").trigger("change"),$("#"+e+"datiProdotto_conservatoria").val(conservatoria),$(this).addClass("hidden")})},bindSms:function(e){$("#"+e+"opzioniProdotto_sms").prop("checked")?($("#datiSmsNumero").removeClass("hidden"),$("#datiSmsNumero").find("input:text").prop("required",!0)):($("#datiSmsNumero").addClass("hidden"),$("#datiSmsNumero").find("input:text").prop("required",!1),$("#datiSmsNumero").find("input:text").val("")),$("#"+e+"opzioniProdotto_sms").click(function(){$("#"+e+"opzioniProdotto_sms").prop("checked")?($("#datiSmsNumero").removeClass("hidden"),$("#datiSmsNumero").find("input:text").prop("required",!0)):($("#datiSmsNumero").addClass("hidden"),$("#datiSmsNumero").find("input:text").prop("required",!1),$("#datiSmsNumero").find("input:text").val(""))})},bindProvinciaComune:function(e){$("#"+e+"cliente_provincia").change(function(){Tuttovisure.provinciaComune($(this),"#"+e+"cliente_comune")})},bindSpedizione:function(e){$(".spedizione_nazionale input[name*='[spedizione][spedizione_nazionale]']").change(function(){"internazionale"==$(this).val()?($(".spedizione_internazionale").closest("div[class*='row']").removeClass("hidden"),$(".spedizione_internazionale").removeClass("hidden"),$(".spedizione_internazionale").prop("required",!0),$(this).closest("div[class*='row']").removeClass("alert-form"),$(this).closest("div[class*='row']").removeClass("alert-danger-form"),$(this).closest("div[class*='row']").find(".alert-message").remove()):($(".spedizione_internazionale").prop("required",!1),$(".spedizione_internazionale").val(""),$(".spedizione_internazionale").closest("div[class*='row']").addClass("hidden"),$(".spedizione_internazionale").addClass("hidden"),$(".spedizione_internazionale").parent(".row").removeClass("alert-form alert-danger-form"),$(".spedizione_internazionale").find(".alert-message").remove()),Tuttovisure.Ordine.aggiornaParziali()}),$(".spedizione_internazionale").change(function(){Tuttovisure.Ordine.aggiornaParziali()}),"internazionale"==$(".spedizione_nazionale input[name*='[spedizione][spedizione_nazionale]']:checked").val()&&($(".spedizione_internazionale").removeClass("hidden"),$(".spedizione_internazionale").prop("required",!0))},step2:function(e){rivets.bind($("#sidebar_prodotto"),{parziali:Tuttovisure.parziali}),Tuttovisure.Cliente.validaForm(e),$("#scegliUrgenzaStart").css("display","none"),$("#consegnaUrgente .fakeInput").css("display","none")},step3:function(){$("#checkOut").removeClass("hidden")}},function(){function n(e,t,i,n){return new o(e,t,i,n)}function o(e,t,i,n){this.options=n||{},this.options.adapters=this.options.adapters||{},this.obj=e,this.keypath=t,this.callback=i,this.objectPath=[],this.parse(),r(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function r(e){return"object"==typeof e&&null!==e}function s(e){throw new Error("[sightglass] "+e)}n.adapters={},o.tokenize=function(e,t,i){var n,o,r=[],s={i:i,path:""};for(n=0;n<e.length;n++)o=e.charAt(n),~t.indexOf(o)?(r.push(s),s={i:o,path:""}):s.path+=o;return r.push(s),r},o.prototype.parse=function(){var e,t,i=this.interfaces();i.length||s("Must define at least one adapter interface."),t=~i.indexOf(this.keypath[0])?(e=this.keypath[0],this.keypath.substr(1)):(void 0===(e=this.options.root||n.root)&&s("Must define a default root adapter."),this.keypath),this.tokens=o.tokenize(t,i,e),this.key=this.tokens.pop()},o.prototype.realize=function(){var i,n=this.obj,o=!1;return this.tokens.forEach(function(e,t){r(n)?(void 0!==this.objectPath[t]?n!==(i=this.objectPath[t])&&(this.set(!1,e,i,this.update.bind(this)),this.set(!0,e,n,this.update.bind(this)),this.objectPath[t]=n):(this.set(!0,e,n,this.update.bind(this)),this.objectPath[t]=n),n=this.get(e,n)):(!1===o&&(o=t),(i=this.objectPath[t])&&this.set(!1,e,i,this.update.bind(this)))},this),!1!==o&&this.objectPath.splice(o),n},o.prototype.update=function(){var e,t;(e=this.realize())!==this.target&&(r(this.target)&&this.set(!1,this.key,this.target,this.callback),r(e)&&this.set(!0,this.key,e,this.callback),t=this.value(),this.target=e,this.value()!==t&&this.callback())},o.prototype.value=function(){if(r(this.target))return this.get(this.key,this.target)},o.prototype.setValue=function(e){r(this.target)&&this.adapter(this.key).set(this.target,this.key.path,e)},o.prototype.get=function(e,t){return this.adapter(e).get(t,e.path)},o.prototype.set=function(e,t,i,n){var o=e?"observe":"unobserve";this.adapter(t)[o](i,t.path,n)},o.prototype.interfaces=function(){var t=Object.keys(this.options.adapters);return Object.keys(n.adapters).forEach(function(e){~t.indexOf(e)||t.push(e)}),t},o.prototype.adapter=function(e){return this.options.adapters[e.i]||n.adapters[e.i]},o.prototype.unobserve=function(){var i;this.tokens.forEach(function(e,t){(i=this.objectPath[t])&&this.set(!1,e,i,this.update.bind(this))},this),r(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define([],function(){return this.sightglass=n}):this.sightglass=n}.call(this),function(){function m(e,t){return function(){return e.apply(t,arguments)}}function e(e,t){for(var i in t)s.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e}var k,n,o,t,i,r,v=[].slice,s={}.hasOwnProperty,c=[].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1};function a(){}function l(){}function d(e,t,i){var n,o,r,s,a,l,d,u,c,p,h,f,v;for(this.els=e,this.models=t,null==i&&(i={}),this.update=m(this.update,this),this.publish=m(this.publish,this),this.sync=m(this.sync,this),this.unbind=m(this.unbind,this),this.bind=m(this.bind,this),this.select=m(this.select,this),this.traverse=m(this.traverse,this),this.build=m(this.build,this),this.buildBinding=m(this.buildBinding,this),this.bindingRegExp=m(this.bindingRegExp,this),this.options=m(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),a=0,d=(c=k.extensions).length;a<d;a++){if(this[o=c[a]]={},i[o])for(n in p=i[o])r=p[n],this[o][n]=r;for(n in h=k.public[o])r=h[n],null==(s=this[o])[n]&&(s[n]=r)}for(l=0,u=(f=k.options).length;l<u;l++)this[o=f[l]]=null!=(v=i[o])?v:k.public[o];this.build()}function u(e,t,i,n,o){this.view=e,this.el=t,this.type=i,this.keypath=n,this.options=null!=o?o:{},this.getValue=m(this.getValue,this),this.update=m(this.update,this),this.unbind=m(this.unbind,this),this.bind=m(this.bind,this),this.publish=m(this.publish,this),this.sync=m(this.sync,this),this.set=m(this.set,this),this.eventHandler=m(this.eventHandler,this),this.formattedValue=m(this.formattedValue,this),this.parseTarget=m(this.parseTarget,this),this.observe=m(this.observe,this),this.setBinder=m(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}function p(e,t,i){var n,o,r,s,a,l,d;for(this.view=e,this.el=t,this.type=i,this.unbind=m(this.unbind,this),this.bind=m(this.bind,this),this.locals=m(this.locals,this),this.component=this.view.components[this.type],this.static={},this.observers={},this.upstreamObservers={},o=e.bindingRegExp(),s=0,a=(l=this.el.attributes||[]).length;s<a;s++)n=l[s],o.test(n.name)||(r=this.camelCase(n.name),0<=c.call(null!=(d=this.component.static)?d:[],r)?this.static[r]=n.value:this.observers[r]=n.value)}function h(e,t,i,n,o){this.view=e,this.el=t,this.type=i,this.keypath=n,this.options=null!=o?o:{},this.sync=m(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}k={options:["prefix","templateDelimiters","rootInterface","preloadData","handler"],extensions:["binders","formatters","components","adapters"],public:{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,handler:function(e,t,i){return this.call(e,t,i.view.models)},configure:function(e){var t,i,n,o;for(n in null==e&&(e={}),e)if(o=e[n],"binders"===n||"components"===n||"formatters"===n||"adapters"===n)for(i in o)t=o[i],k[n][i]=t;else k.public[n]=o},bind:function(e,t,i){var n;return null==t&&(t={}),null==i&&(i={}),(n=new k.View(e,t,i)).bind(),n},init:function(e,t,i){var n,o;return null==i&&(i={}),null==t&&(t=document.createElement("div")),e=k.public.components[e],t.innerHTML=e.template.call(this,t),n=e.initialize.call(this,t,i),(o=new k.View(t,n)).bind(),o}}},window.jQuery||window.$?(t="on"in jQuery.prototype?["on","off"]:["bind","unbind"],n=t[0],o=t[1],k.Util={bindEvent:function(e,t,i){return jQuery(e)[n](t,i)},unbindEvent:function(e,t,i){return jQuery(e)[o](t,i)},getInputValue:function(e){var t;return"checkbox"===(t=jQuery(e)).attr("type")?t.is(":checked"):t.val()}}):k.Util={bindEvent:"addEventListener"in window?function(e,t,i){return e.addEventListener(t,i,!1)}:function(e,t,i){return e.attachEvent("on"+t,i)},unbindEvent:"removeEventListener"in window?function(e,t,i){return e.removeEventListener(t,i,!1)}:function(e,t,i){return e.detachEvent("on"+t,i)},getInputValue:function(e){var t,i,n,o;if("checkbox"===e.type)return e.checked;if("select-multiple"!==e.type)return e.value;for(o=[],i=0,n=e.length;i<n;i++)(t=e[i]).selected&&o.push(t.value);return o}},k.TypeParser=(a.types={primitive:0,keypath:1},a.parse=function(e){return/^'.*'$|^".*"$/.test(e)?{type:this.types.primitive,value:e.slice(1,-1)}:"true"===e?{type:this.types.primitive,value:!0}:"false"===e?{type:this.types.primitive,value:!1}:"null"===e?{type:this.types.primitive,value:null}:"undefined"===e?{type:this.types.primitive,value:void 0}:!1===isNaN(Number(e))?{type:this.types.primitive,value:Number(e)}:{type:this.types.keypath,value:e}},a),k.TextTemplateParser=(l.types={text:0,binding:1},l.parse=function(e,t){var i,n,o,r,s,a,l;for(a=[],r=e.length,n=i=0;n<r;){if((i=e.indexOf(t[0],n))<0){a.push({type:this.types.text,value:e.slice(n)});break}if(0<i&&n<i&&a.push({type:this.types.text,value:e.slice(n,i)}),n=i+t[0].length,(i=e.indexOf(t[1],n))<0){s=e.slice(n-t[1].length),(null!=(o=a[a.length-1])?o.type:void 0)===this.types.text?o.value+=s:a.push({type:this.types.text,value:s});break}l=e.slice(n,i).trim(),a.push({type:this.types.binding,value:l}),n=i+t[1].length}return a},l),k.View=(d.prototype.options=function(){var e,t,i,n,o;for(t={},i=0,n=(o=k.extensions.concat(k.options)).length;i<n;i++)t[e=o[i]]=this[e];return t},d.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},d.prototype.buildBinding=function(e,t,i,o){var n,r,s,a,l,d,u;return l={},u=function(){var e,t,i,n;for(n=[],e=0,t=(i=o.split("|")).length;e<t;e++)d=i[e],n.push(d.trim());return n}(),a=(n=function(){var e,t,i,n;for(n=[],e=0,t=(i=u.shift().split("<")).length;e<t;e++)r=i[e],n.push(r.trim());return n}()).shift(),l.formatters=u,(s=n.shift())&&(l.dependencies=s.split(/\s+/)),this.bindings.push(new k[e](this,t,i,a,l))},d.prototype.build=function(){var e,v,t,i,n,m;for(this.bindings=[],v=function(o){var e,t,i,r,n,s,a,l,d,u,c,p,h,f;if(3===o.nodeType){if(n=k.TextTemplateParser,(i=m.templateDelimiters)&&(l=n.parse(o.data,i)).length&&(1!==l.length||l[0].type!==n.types.text)){for(d=0,c=l.length;d<c;d++)a=l[d],s=document.createTextNode(a.value),o.parentNode.insertBefore(s,o),1===a.type&&m.buildBinding("TextBinding",s,null,a.value);o.parentNode.removeChild(o)}}else 1===o.nodeType&&(e=m.traverse(o));if(!e){for(f=[],u=0,p=(h=function(){var e,t,i,n;for(n=[],e=0,t=(i=o.childNodes).length;e<t;e++)r=i[e],n.push(r);return n}()).length;u<p;u++)t=h[u],f.push(v(t));return f}},t=0,i=(n=(m=this).els).length;t<i;t++)e=n[t],v(e);this.bindings.sort(function(e,t){var i,n;return((null!=(i=t.binder)?i.priority:void 0)||0)-((null!=(n=e.binder)?n.priority:void 0)||0)})},d.prototype.traverse=function(e){var t,i,n,o,r,s,a,l,d,u,c,p,h,f,v;for(o=this.bindingRegExp(),r="SCRIPT"===e.nodeName||"STYLE"===e.nodeName,d=0,c=(h=e.attributes).length;d<c;d++)if(t=h[d],o.test(t.name)){if(a=t.name.replace(o,""),!(n=this.binders[a]))for(s in f=this.binders)l=f[s],"*"!==s&&-1!==s.indexOf("*")&&new RegExp("^"+s.replace(/\*/g,".+")+"$").test(a)&&(n=l);(n=n||this.binders["*"]).block&&(r=!0,i=[t])}for(u=0,p=(v=i||e.attributes).length;u<p;u++)t=v[u],o.test(t.name)&&(a=t.name.replace(o,""),this.buildBinding("Binding",e,a,t.value));return r||(a=e.nodeName.toLowerCase(),this.components[a]&&!e._bound&&(this.bindings.push(new k.ComponentBinding(this,e,a)),r=!0)),r},d.prototype.select=function(e){var t,i,n,o,r;for(r=[],i=0,n=(o=this.bindings).length;i<n;i++)e(t=o[i])&&r.push(t);return r},d.prototype.bind=function(){var e,t,i,n,o;for(o=[],t=0,i=(n=this.bindings).length;t<i;t++)e=n[t],o.push(e.bind());return o},d.prototype.unbind=function(){var e,t,i,n,o;for(o=[],t=0,i=(n=this.bindings).length;t<i;t++)e=n[t],o.push(e.unbind());return o},d.prototype.sync=function(){var e,t,i,n,o;for(o=[],t=0,i=(n=this.bindings).length;t<i;t++)e=n[t],o.push("function"==typeof e.sync?e.sync():void 0);return o},d.prototype.publish=function(){var e,t,i,n,o;for(o=[],t=0,i=(n=this.select(function(e){var t;return null!=(t=e.binder)?t.publishes:void 0})).length;t<i;t++)e=n[t],o.push(e.publish());return o},d.prototype.update=function(e){var t,i,n,o,r,s,a;for(i in null==e&&(e={}),e)n=e[i],this.models[i]=n;for(a=[],o=0,r=(s=this.bindings).length;o<r;o++)t=s[o],a.push("function"==typeof t.update?t.update(e):void 0);return a},d),k.Binding=(u.prototype.setBinder=function(){var e,t,i;if(!(this.binder=this.view.binders[this.type]))for(e in i=this.view.binders)t=i[e],"*"!==e&&-1!==e.indexOf("*")&&new RegExp("^"+e.replace(/\*/g,".+")+"$").test(this.type)&&(this.binder=t,this.args=new RegExp("^"+e.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift());if(this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function)return this.binder={routine:this.binder}},u.prototype.observe=function(e,t,i){return k.sightglass(e,t,i,{root:this.view.rootInterface,adapters:this.view.adapters})},u.prototype.parseTarget=function(){var e;return 0===(e=k.TypeParser.parse(this.keypath)).type?this.value=e.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},u.prototype.formattedValue=function(e){var t,n,o,i,r,s,a,l,d,u,c,p,h,f;for(i=u=0,p=(f=this.formatters).length;u<p;i=++u){for(r=f[i],s=(o=r.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g)).shift(),r=this.view.formatters[s],l=[],t=c=0,h=(o=function(){var e,t,i;for(i=[],e=0,t=o.length;e<t;e++)n=o[e],i.push(k.TypeParser.parse(n));return i}()).length;c<h;t=++c)n=o[t],l.push(0===n.type?n.value:((d=this.formatterObservers)[i]||(d[i]={}),(a=this.formatterObservers[i][t])||(a=this.observe(this.view.models,n.value,this.sync),this.formatterObservers[i][t]=a),a.value()));(null!=r?r.read:void 0)instanceof Function?e=r.read.apply(r,[e].concat(v.call(l))):r instanceof Function&&(e=r.apply(null,[e].concat(v.call(l))))}return e},u.prototype.eventHandler=function(t){var i,n;return n=(i=this).view.handler,function(e){return n.call(t,this,e,i)}},u.prototype.set=function(e){var t;return e=e instanceof Function&&!this.binder.function?this.formattedValue(e.call(this.model)):this.formattedValue(e),null!=(t=this.binder.routine)?t.call(this,this.el,e):void 0},u.prototype.sync=function(){var a,l;return this.set(function(){var e,t,i,n,o,r,s;if(this.observer){if(this.model!==this.observer.target){for(e=0,i=(o=this.dependencies).length;e<i;e++)(l=o[e]).unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&null!=(r=this.options.dependencies)&&r.length)for(t=0,n=(s=this.options.dependencies).length;t<n;t++)a=s[t],l=this.observe(this.model,a,this.sync),this.dependencies.push(l)}return this.observer.value()}return this.value}.call(this))},u.prototype.publish=function(){var e,t,i,n,o,r,s,a;if(this.observer){for(i=this.getValue(this.el),n=0,o=(r=this.formatters.slice(0).reverse()).length;n<o;n++)t=(e=r[n].split(/\s+/)).shift(),null!=(s=this.view.formatters[t])&&s.publish&&(i=(a=this.view.formatters[t]).publish.apply(a,[i].concat(v.call(e))));return this.observer.setValue(i)}},u.prototype.bind=function(){var e,t,i,n,o,r,s;if(this.parseTarget(),null!=(o=this.binder.bind)&&o.call(this,this.el),null!=this.model&&null!=(r=this.options.dependencies)&&r.length)for(i=0,n=(s=this.options.dependencies).length;i<n;i++)e=s[i],t=this.observe(this.model,e,this.sync),this.dependencies.push(t);if(this.view.preloadData)return this.sync()},u.prototype.unbind=function(){var e,t,i,n,o,r,s,a,l;for(null!=(r=this.binder.unbind)&&r.call(this,this.el),null!=(s=this.observer)&&s.unobserve(),n=0,o=(a=this.dependencies).length;n<o;n++)a[n].unobserve();for(i in this.dependencies=[],l=this.formatterObservers)for(e in t=l[i])t[e].unobserve();return this.formatterObservers={}},u.prototype.update=function(e){var t,i;return null==e&&(e={}),this.model=null!=(t=this.observer)?t.target:void 0,null!=(i=this.binder.update)?i.call(this,e):void 0},u.prototype.getValue=function(e){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,e):k.Util.getInputValue(e)},u),k.ComponentBinding=(i=k.Binding,e(p,i),p.prototype.sync=function(){},p.prototype.update=function(){},p.prototype.publish=function(){},p.prototype.locals=function(){var e,t,i,n,o,r;for(e in i={},o=this.static)n=o[e],i[e]=n;for(e in r=this.observers)t=r[e],i[e]=t.value();return i},p.prototype.camelCase=function(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})},p.prototype.bind=function(){var e,t,i,n,o,r,s,a,l,d,u,c,p,h,f,v,m,b,g,$,y;if(!this.bound){for(t in h=this.observers)i=h[t],this.observers[t]=this.observe(this.view.models,i,function(t){return function(e){return function(){return t.componentView.models[e]=t.observers[e].value()}}}(this).call(this,t));this.bound=!0}if(null!=this.componentView)return this.componentView.bind();for(this.el.innerHTML=this.component.template.call(this),s=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,r={},d=0,c=(f=k.extensions).length;d<c;d++){if(r[o=f[d]]={},this.component[o])for(e in v=this.component[o])a=v[e],r[o][e]=a;for(e in m=this.view[o])a=m[e],null==(l=r[o])[e]&&(l[e]=a)}for(u=0,p=(b=k.options).length;u<p;u++)r[o=b[u]]=null!=(g=this.component[o])?g:this.view[o];for(t in this.componentView=new k.View(this.el,s,r),this.componentView.bind(),y=[],$=this.observers)n=$[t],y.push(this.upstreamObservers[t]=this.observe(this.componentView.models,t,function(i){return function(e,t){return function(){return t.setValue(i.componentView.models[e])}}}(this).call(this,t,n)));return y},p.prototype.unbind=function(){var e,t,i,n;for(e in t=this.upstreamObservers)t[e].unobserve();for(e in i=this.observers)i[e].unobserve();return null!=(n=this.componentView)?n.unbind.call(this):void 0},p),k.TextBinding=(r=k.Binding,e(h,r),h.prototype.binder={routine:function(e,t){return e.data=null!=t?t:""}},h.prototype.sync=function(){return h.__super__.sync.apply(this,arguments)},h),k.public.binders.text=function(e,t){return null!=e.textContent?e.textContent=null!=t?t:"":e.innerText=null!=t?t:""},k.public.binders.html=function(e,t){return e.innerHTML=null!=t?t:""},k.public.binders.show=function(e,t){return e.style.display=t?"":"none"},k.public.binders.hide=function(e,t){return e.style.display=t?"none":""},k.public.binders.enabled=function(e,t){return e.disabled=!t},k.public.binders.disabled=function(e,t){return e.disabled=!!t},k.public.binders.checked={publishes:!0,priority:2e3,bind:function(e){return k.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return k.Util.unbindEvent(e,"change",this.publish)},routine:function(e,t){var i;return"radio"===e.type?e.checked=(null!=(i=e.value)?i.toString():void 0)===(null!=t?t.toString():void 0):e.checked=!!t}},k.public.binders.unchecked={publishes:!0,priority:2e3,bind:function(e){return k.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return k.Util.unbindEvent(e,"change",this.publish)},routine:function(e,t){var i;return"radio"===e.type?e.checked=(null!=(i=e.value)?i.toString():void 0)!==(null!=t?t.toString():void 0):e.checked=!t}},k.public.binders.value={publishes:!0,priority:3e3,bind:function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return this.event="SELECT"===e.tagName?"change":"input",k.Util.bindEvent(e,this.event,this.publish)},unbind:function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return k.Util.unbindEvent(e,this.event,this.publish)},routine:function(e,t){var i,n,o,r,s,a,l;if("INPUT"===e.tagName&&"radio"===e.type)return e.setAttribute("value",t);if(null!=window.jQuery){if(e=jQuery(e),(null!=t?t.toString():void 0)!==(null!=(r=e.val())?r.toString():void 0))return e.val(null!=t?t:"")}else if("select-multiple"===e.type){if(null!=t){for(l=[],n=0,o=e.length;n<o;n++)i=e[n],l.push(i.selected=(s=i.value,0<=c.call(t,s)));return l}}else if((null!=t?t.toString():void 0)!==(null!=(a=e.value)?a.toString():void 0))return e.value=null!=t?t:""}},k.public.binders.if={block:!0,priority:4e3,bind:function(e){var t,i;if(null==this.marker)return t=[this.view.prefix,this.type].join("-").replace("--","-"),i=e.getAttribute(t),this.marker=document.createComment(" rivets: "+this.type+" "+i+" "),this.bound=!1,e.removeAttribute(t),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e)},unbind:function(){var e;return null!=(e=this.nested)?e.unbind():void 0},routine:function(e,t){var i,n,o,r;if(!!t==!this.bound){if(t){for(i in o={},r=this.view.models)n=r[i],o[i]=n;return(this.nested||(this.nested=new k.View(e,o,this.view.options()))).bind(),this.marker.parentNode.insertBefore(e,this.marker.nextSibling),this.bound=!0}return e.parentNode.removeChild(e),this.nested.unbind(),this.bound=!1}},update:function(e){var t;return null!=(t=this.nested)?t.update(e):void 0}},k.public.binders.unless={block:!0,priority:4e3,bind:function(e){return k.public.binders.if.bind.call(this,e)},unbind:function(){return k.public.binders.if.unbind.call(this)},routine:function(e,t){return k.public.binders.if.routine.call(this,e,!t)},update:function(e){return k.public.binders.if.update.call(this,e)}},k.public.binders["on-*"]={function:!0,priority:1e3,unbind:function(e){if(this.handler)return k.Util.unbindEvent(e,this.args[0],this.handler)},routine:function(e,t){return this.handler&&k.Util.unbindEvent(e,this.args[0],this.handler),k.Util.bindEvent(e,this.args[0],this.handler=this.eventHandler(t))}},k.public.binders["each-*"]={block:!0,priority:4e3,bind:function(e){var t,i,n,o;if(null==this.marker)t=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],e.removeAttribute(t),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e);else for(i=0,n=(o=this.iterated).length;i<n;i++)o[i].bind()},unbind:function(e){var t,i,n,o,r;if(null!=this.iterated){for(r=[],i=0,n=(o=this.iterated).length;i<n;i++)t=o[i],r.push(t.unbind());return r}},routine:function(e,t){var i,n,o,r,s,a,l,d,u,c,p,h,f,v,m,b,g,$,y,z;if(a=this.args[0],t=t||[],this.iterated.length>t.length)for(p=0,v=(g=Array(this.iterated.length-t.length)).length;p<v;p++)g[p],(c=this.iterated.pop()).unbind(),this.marker.parentNode.removeChild(c.els[0]);for(o=h=0,m=t.length;h<m;o=++h)if(s=t[o],(n={index:o})[a]=s,null==this.iterated[o]){for(r in $=this.view.models)s=$[r],null==n[r]&&(n[r]=s);d=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,(l=this.view.options()).preloadData=!0,u=e.cloneNode(!0),(c=new k.View(u,n,l)).bind(),this.iterated.push(c),this.marker.parentNode.insertBefore(u,d.nextSibling)}else this.iterated[o].models[a]!==s&&this.iterated[o].update(n);if("OPTION"===e.nodeName){for(z=[],f=0,b=(y=this.view.bindings).length;f<b;f++)(i=y[f]).el===this.marker.parentNode&&"value"===i.type?z.push(i.sync()):z.push(void 0);return z}},update:function(e){var t,i,n,o,r,s,a,l;for(i in t={},e)n=e[i],i!==this.args[0]&&(t[i]=n);for(l=[],r=0,s=(a=this.iterated).length;r<s;r++)o=a[r],l.push(o.update(t));return l}},k.public.binders["class-*"]=function(e,t){var i;if(!t==(-1!==(i=" "+e.className+" ").indexOf(" "+this.args[0]+" ")))return e.className=t?e.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim()},k.public.binders["*"]=function(e,t){return null!=t?e.setAttribute(this.type,t):e.removeAttribute(this.type)},k.public.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(e){var t,i,n;return e.hasOwnProperty(this.id)||(t=this.counter++,Object.defineProperty(e,this.id,{value:t})),(i=this.weakmap)[n=e[this.id]]||(i[n]={callbacks:{}})},cleanupWeakReference:function(e,t){if(!(Object.keys(e.callbacks).length||e.pointers&&Object.keys(e.pointers).length))return delete this.weakmap[t]},stubFunction:function(d,e){var u,c,p;return c=d[e],u=this.weakReference(d),p=this.weakmap,d[e]=function(){var e,t,i,n,o,r,s,a,l;for(t in i=c.apply(d,arguments),r=u.pointers)for(e=r[t],n=0,o=(l=null!=(s=null!=(a=p[t])?a.callbacks[e]:void 0)?s:[]).length;n<o;n++)(0,l[n])();return i}},observeMutations:function(e,t,i){var n,o,r,s,a,l;if(Array.isArray(e)){if(null==(r=this.weakReference(e)).pointers)for(r.pointers={},a=0,l=(o=["push","pop","shift","unshift","sort","reverse","splice"]).length;a<l;a++)n=o[a],this.stubFunction(e,n);if(null==(s=r.pointers)[t]&&(s[t]=[]),c.call(r.pointers[t],i)<0)return r.pointers[t].push(i)}},unobserveMutations:function(e,t,i){var n,o,r;if(Array.isArray(e)&&null!=e[this.id]&&(o=this.weakmap[e[this.id]])&&(r=o.pointers[t]))return 0<=(n=r.indexOf(i))&&r.splice(n,1),r.length||delete o.pointers[t],this.cleanupWeakReference(o,e[this.id])},observe:function(r,s,a){var l,e,d,u;return null==(l=this.weakReference(r).callbacks)[s]&&(l[s]=[],null!=(e=Object.getOwnPropertyDescriptor(r,s))&&e.get||null!=e&&e.set||(d=r[s],Object.defineProperty(r,s,{enumerable:!0,get:function(){return d},set:(u=this,function(e){var t,i,n,o;if(e!==d&&(u.unobserveMutations(d,r[u.id],s),d=e,t=u.weakmap[r[u.id]])){if((l=t.callbacks)[s])for(i=0,n=(o=l[s].slice()).length;i<n;i++)a=o[i],0<=c.call(l[s],a)&&a();return u.observeMutations(e,r[u.id],s)}})}))),c.call(l[s],a)<0&&l[s].push(a),this.observeMutations(r[s],r[this.id],s)},unobserve:function(e,t,i){var n,o,r;if((r=this.weakmap[e[this.id]])&&(n=r.callbacks[t]))return 0<=(o=n.indexOf(i))&&(n.splice(o,1),n.length||delete r.callbacks[t]),this.unobserveMutations(e[t],e[this.id],t),this.cleanupWeakReference(r,e[this.id])},get:function(e,t){return e[t]},set:function(e,t,i){return e[t]=i}},k.factory=function(e){return k.sightglass=e,(k.public._=k).public},"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=k.factory(require("sightglass")):"function"==typeof define&&define.amd?define(["sightglass"],function(e){return this.rivets=k.factory(e)}):this.rivets=k.factory(sightglass)}.call(this);